FROM registry.cn-beijing.aliyuncs.com/licsber/github:openwrt-lede-env
LABEL org.opencontainers.image.authors="licsber<admin@licsber.site>"

ENV FORCE_UNSAFE_CONFIGURE=1

WORKDIR /licsber/lede
COPY openwrt.lede.x86.config .config

RUN ./scripts/feeds update -a && \
    ./scripts/feeds install -a

RUN make defconfig && \
    make download -j8

RUN echo `nproc` && make -j4 || make -j1 V=s && \
    echo $?

CMD ['bash']
